# Problem 04: Count total requests and total download size by month

## Requirements
- python3
- hadoop
- mrjob

## Solution Implementation
```python
from mrjob.job import MRJob
import re
class MRImageCount(MRJob):
	def mapper(self, _, line):
		pattern = r"\[([0-9]{2})/([A-Za-z]{3})/([0-9]{4}):([0-9]{2}):([0-9]{2}):([0-9]{2}) [+-]([0-9]{4})\]"
		date = re.search(pattern, line)
		if date:
			date = date.groups()
			mm = date[1]
			yy = date[2]
			pattern = r"\" (\d{3}) (\d*) \""
			date = "{}-{}".format(yy, mm)
			size = re.search(pattern, line)
			if size:
				size = size.groups()[1]
				yield (date, (1, int(size)))

	def reducer(self, month, iterator):
		requests, size = map(sum, zip(*iterator))
		yield(month, (requests, size))
if __name__ == '__main__':
	MRImageCount.run()
```

## How to Run Solution
To run the fractions operation in python program, grab a copy of the current directory
from GitHub. After that, get the latest version of `python` and install `mrjob` using following command
```console
pip install mrjob
```
Now, all you have to do is run the following command from the command line:
```console
python MonthSummary.py input/web_access_log.txt -r hadoop > output/month_summary.txt
```

## Output
The output file generated by hadoop is located in output directory.

|    Month    | requests | total downloads |
|-------------|----------|-----------------|
| "2016-Feb"  |  64113   |    1412992330   |
| "2015-Dec"  |  13670   |    286876754    |
| "2016-Jan"  |  28066   |    1840853769   |

